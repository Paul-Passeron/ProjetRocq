\coqlibrary{projet rocq passeron rousseau}{Library }{projet\_rocq\_passeron\_rousseau}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{List}.\coqdoceol
\coqdocnoindent
\coqdockw{Import} \coqdocvar{ListNotations}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Coq.Arith.PeanoNat}.\coqdoceol
\coqdocnoindent
\coqdockw{Import} \coqdocvar{Nat}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Parameter} \coqdocvar{A}: \coqdockw{Type}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Parameter} \coqdocvar{A\_eq\_dec}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{x} \coqdocvar{y}: \coqdocvar{A}), \{\coqdocvar{x}=\coqdocvar{y}\} + \{\~{}\coqdocvar{x}=\coqdocvar{y}\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdoctac{repeat} (\coqdocvar{x}: \coqdocvar{A}) (\coqdocvar{n}: \coqdocvar{nat}): \coqdocvar{list} \coqdocvar{A} :=\coqdoceol
\coqdocindent{0.50em}
\coqdockw{match} \coqdocvar{n} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} 0  \ensuremath{\Rightarrow} []\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{S} (\coqdocvar{n'}) \ensuremath{\Rightarrow} \coqdocvar{x}::(\coqdoctac{repeat} \coqdocvar{x} \coqdocvar{n'})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{repeat\_sound1}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{a}: \coqdocvar{A}) \coqdocvar{n},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{Forall} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocvar{x}=\coqdocvar{a}) (\coqdoctac{repeat} \coqdocvar{a} \coqdocvar{n}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocnoindent
- \coqdoctac{unfold} \coqdoctac{repeat}. \coqdoctac{apply} \coqdocvar{Forall\_nil}.\coqdoceol
\coqdocnoindent
- \coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{Forall\_cons}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{exact} \coqdocvar{IHn}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{repeat\_sound2}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{a}: \coqdocvar{A}) \coqdocvar{n},\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{length} (\coqdoctac{repeat} \coqdocvar{a} \coqdocvar{n}) = \coqdocvar{n}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{n}.\coqdoceol
\coqdocnoindent
- \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
- \coqdoctac{simpl}. \coqdoctac{rewrite} \coqdocvar{IHn}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{split\_p\_aux} (\coqdocvar{p}: \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}) (\coqdocvar{acc}: \coqdocvar{list} \coqdocvar{A}) :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} (\coqdocvar{acc}, [])\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{head}::\coqdocvar{tail} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{p} \coqdocvar{head} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{true} \ensuremath{\Rightarrow} (\coqdocvar{acc}, \coqdocvar{l})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdocvar{split\_p\_aux} \coqdocvar{p} \coqdocvar{tail} (\coqdocvar{acc} ++ [\coqdocvar{head}])\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{split\_p\_acc} (\coqdocvar{p}: \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A})  := \coqdocvar{split\_p\_aux} \coqdocvar{p} \coqdocvar{l} [].\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{split\_p} (\coqdocvar{p}: \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}) :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{l} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} ([], [])\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{head}::\coqdocvar{tail} \ensuremath{\Rightarrow} \coqdockw{match} \coqdocvar{p} \coqdocvar{head} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{true} \ensuremath{\Rightarrow} ([], \coqdocvar{l})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{false} \ensuremath{\Rightarrow} \coqdockw{let} (\coqdoctac{left}, \coqdoctac{right}) := \coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{tail} \coqdoctac{in} (\coqdocvar{head}::\coqdoctac{left}, \coqdoctac{right})\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{split\_p\_first} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{p} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{A}),\coqdoceol
\coqdocnoindent
\coqdocvar{Forall} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocvar{p} \coqdocvar{x} = \coqdocvar{false}) (\coqdocvar{fst} (\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l})) .\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
-\coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{Forall\_nil}.\coqdoceol
\coqdocnoindent
- \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{p} \coqdocvar{a}) \coqdocvar{eqn}:\coqdocvar{Ha}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{Forall\_nil}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{destruct} (\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l}) \coqdocvar{eqn}:\coqdocvar{Hsplit}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{Forall\_cons}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{exact} \coqdocvar{Ha}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{IHl}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{exact} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{split\_p\_snd} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{p} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l} \coqdocvar{l1} \coqdocvar{l2} : \coqdocvar{list} \coqdocvar{A}) \coqdocvar{x},\coqdoceol
\coqdocnoindent
\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l} = (\coqdocvar{l1}, \coqdocvar{l2}) \ensuremath{\rightarrow} \coqdocvar{head} \coqdocvar{l2} = \coqdocvar{Some} \coqdocvar{x} \ensuremath{\rightarrow} \coqdocvar{p} \coqdocvar{x} = \coqdocvar{true}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l} \coqdockw{as} [| \coqdocvar{a} \coqdocvar{l'} \coqdocvar{IHl'}].\coqdoceol
\coqdocnoindent
- \coqdoctac{intros} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{x} \coqdocvar{Hsplit} \coqdocvar{Hhead}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Hsplit}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{injection} \coqdocvar{Hsplit}. \coqdoctac{intros} \coqdocvar{H2} \coqdocvar{\_}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H2} \coqdoctac{in} \coqdocvar{Hhead}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{discriminate} \coqdocvar{Hhead}.\coqdoceol
\coqdocindent{0.50em}
- \coqdoctac{intros} \coqdocvar{l1} \coqdocvar{l2} \coqdocvar{x} \coqdocvar{Hsplit} \coqdocvar{Hhead}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Hsplit}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{a})\coqdocvar{eqn}:\coqdocvar{Pa}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{injection} \coqdocvar{Hsplit} \coqdockw{as} \coqdocvar{Hl1} \coqdocvar{Hl2}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{Hl2} \coqdoctac{in} \coqdocvar{Hhead}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Hhead}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{inversion} \coqdocvar{Hhead} \coqdockw{as} [\coqdocvar{AeqX}].\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{AeqX}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{exact} \coqdocvar{Pa}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{destruct} (\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l'}) \coqdockw{as} [\coqdoctac{left} \coqdoctac{right}] \coqdocvar{eqn}:\coqdocvar{Hsplit'}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{injection} \coqdocvar{Hsplit} \coqdockw{as} \coqdocvar{Hl1} \coqdocvar{Hl2}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{eapply} (\coqdocvar{IHl'} \coqdoctac{left} \coqdoctac{right}).\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{rewrite} \coqdocvar{Hl2}. \coqdoctac{exact} \coqdocvar{Hhead}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{split\_p\_forall} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{p} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{A}),\coqdoceol
\coqdocnoindent
\coqdocvar{Forall} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocvar{p} \coqdocvar{x} = \coqdocvar{true}) \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l} = ([], \coqdocvar{l}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p}. \coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intros} \coqdocvar{\_}. \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intro} \coqdocvar{Hyp}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{a}) \coqdocvar{eqn}:\coqdocvar{Pa}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{destruct} (\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \coqdocvar{Forall\_forall} \coqdoctac{in} \coqdocvar{Hyp}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{specialize} (\coqdocvar{Hyp} \coqdocvar{a}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Hyp}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocvar{p} \coqdocvar{a} = \coqdocvar{true}) \coqdockw{as} \coqdocvar{PaTrue}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{apply} \coqdocvar{Hyp}. \coqdoctac{left}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{rewrite} \coqdocvar{PaTrue} \coqdoctac{in} \coqdocvar{Pa}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{discriminate} \coqdocvar{Pa}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{split\_p\_forall\_left} : \coqdockw{\ensuremath{\forall}} (\coqdocvar{p} : \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l} : \coqdocvar{list} \coqdocvar{A}),\coqdoceol
\coqdocnoindent
\coqdocvar{Forall} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdocvar{p} \coqdocvar{x} = \coqdocvar{false}) \coqdocvar{l} \ensuremath{\rightarrow} \coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l} = (\coqdocvar{l}, []).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{intros} \coqdocvar{p}. \coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intro} \coqdocvar{Hyp}. \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intro} \coqdocvar{Hyp}. \coqdoctac{simpl}. \coqdoctac{case} (\coqdocvar{p} \coqdocvar{a})\coqdocvar{eqn}:\coqdocvar{Pa}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{assert} (\coqdocvar{p} \coqdocvar{a} = \coqdocvar{false}) \coqdockw{as} \coqdocvar{PaFalse}. \{\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{rewrite} \coqdocvar{Forall\_forall} \coqdoctac{in} \coqdocvar{Hyp}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{specialize} (\coqdocvar{Hyp} \coqdocvar{a}).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqdocvar{Hyp}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{left}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
\}\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \coqdocvar{PaFalse} \coqdoctac{in} \coqdocvar{Pa}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{discriminate} \coqdocvar{Pa}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{destruct} (\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l}) \coqdockw{as} [\coqdoctac{left} \coqdoctac{right}] \coqdocvar{eqn}:\coqdocvar{Hsplit}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{inversion} \coqdocvar{Hyp}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{IHl} \coqdoctac{in} \coqdocvar{H2}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{injection} \coqdocvar{H2} \coqdockw{as} \coqdocvar{HLeft} \coqdocvar{HRight}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \coqdocvar{HLeft}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \coqdocvar{HRight}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{split\_p\_append}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{p}: \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l} \coqdoctac{left} \coqdoctac{right}: \coqdocvar{list} \coqdocvar{A}),\coqdoceol
\coqdocnoindent
\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l} = (\coqdoctac{left}, \coqdoctac{right}) \ensuremath{\rightarrow} \coqdocvar{l} = \coqdocvar{app} \coqdoctac{left} \coqdoctac{right}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p}. \coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intros} \coqdocvar{l} \coqdocvar{r} \coqdocvar{SplitHyp}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{SplitHyp}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{injection} \coqdocvar{SplitHyp} \coqdockw{as} \coqdocvar{HL} \coqdocvar{HR}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{HL}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{HR}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intros} \coqdoctac{left} \coqdoctac{right} \coqdocvar{SplitHyp}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{SplitHyp}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{a}) \coqdocvar{eqn}:\coqdocvar{Pa}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{injection} \coqdocvar{SplitHyp} \coqdockw{as} \coqdocvar{Empty} \coqdocvar{Al}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow}\coqdocvar{Empty}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{Al}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{destruct} (\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l}) \coqdockw{as} [\coqdocvar{Left} \coqdocvar{Right}] \coqdocvar{eqn}:\coqdocvar{Hsplit}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{specialize} (\coqdocvar{IHl} \coqdocvar{Left} \coqdocvar{Right}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert} (\coqdocvar{l} = \coqdocvar{Left} ++ \coqdocvar{Right}).\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{apply} \coqdocvar{IHl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{injection} \coqdocvar{SplitHyp} \coqdockw{as} \coqdocvar{ALeft} \coqdocvar{RRight}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{RRight}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ALeft}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{H}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Lia}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{split\_p\_length}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{p}: \coqdocvar{A} \ensuremath{\rightarrow} \coqdocvar{bool}) (\coqdocvar{l} \coqdoctac{left} \coqdoctac{right}: \coqdocvar{list} \coqdocvar{A}),\coqdoceol
\coqdocnoindent
\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l} = (\coqdoctac{left}, \coqdoctac{right}) \ensuremath{\rightarrow} \coqdocvar{length} \coqdoctac{left} \ensuremath{\le} \coqdocvar{length} \coqdocvar{l} \ensuremath{\land} \coqdocvar{length} \coqdoctac{right} \ensuremath{\le} \coqdocvar{length} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{p}. \coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intros} \coqdoctac{left} \coqdoctac{right} \coqdocvar{SplitHyp}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{SplitHyp}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{injection} \coqdocvar{SplitHyp} \coqdockw{as} \coqdocvar{LEmpty} \coqdocvar{REmpty}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{LEmpty}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{REmpty}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdocvar{lia}.\coqdoceol
\coqdocnoindent
- \coqdoctac{intros} \coqdocvar{L} \coqdocvar{R}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{p} \coqdocvar{a}) \coqdocvar{eqn}:\coqdocvar{Pa}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{split}; \coqdoctac{injection} \coqdocvar{H} \coqdockw{as} \coqdocvar{LEmpty} \coqdocvar{ReqAL}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{LEmpty}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{lia}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{ReqAL}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{lia}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{destruct} (\coqdocvar{split\_p} \coqdocvar{p} \coqdocvar{l}) \coqdockw{as} [\coqdocvar{Left} \coqdocvar{Right}] \coqdocvar{eqn}: \coqdocvar{HSplit}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{intro} \coqdocvar{H}. \coqdoctac{injection} \coqdocvar{H} \coqdockw{as} \coqdocvar{LeqAL} \coqdocvar{REmpty}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{specialize} (\coqdocvar{IHl} \coqdocvar{Left} \coqdocvar{Right}).\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{assert}(\coqdocvar{length} \coqdocvar{Left} \ensuremath{\le} \coqdocvar{length} \coqdocvar{l} \ensuremath{\land}\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{length} \coqdocvar{Right} \ensuremath{\le} \coqdocvar{length} \coqdocvar{l}) \coqdockw{as} \coqdocvar{Rec}.\coqdoceol
\coqdocindent{3.00em}
\{\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{apply} \coqdocvar{IHl}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{3.00em}
\}\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} \coqdocvar{Rec} \coqdockw{as} [\coqdocvar{RL} \coqdocvar{RR}].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{LeqAL}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqdocvar{Nat.succ\_le\_mono} \coqdoctac{in} \coqdocvar{RL}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{assumption}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{REmpty}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{apply} \coqdocvar{le\_S}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Coq.Classes.EquivDec}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Coq.Bool.Bool}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{split\_occ} (\coqdocvar{v}: \coqdocvar{A}) (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}) :=\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{split\_p} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdockw{if} \coqdocvar{A\_eq\_dec} \coqdocvar{x} \coqdocvar{v} \coqdockw{then} \coqdocvar{true} \coqdockw{else} \coqdocvar{false}) \coqdocvar{l}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{split\_occ\_first}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{v}: \coqdocvar{A}) (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}),\coqdoceol
\coqdocnoindent
\coqdocvar{Forall} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \~{}(\coqdocvar{x} = \coqdocvar{v})) (\coqdocvar{fst} (\coqdocvar{split\_occ} \coqdocvar{v} \coqdocvar{l})).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros} \coqdocvar{v}.\coqdoceol
\coqdocnoindent
\coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocnoindent
- \coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{Forall\_nil}.\coqdoceol
\coqdocnoindent
- \coqdoctac{unfold} \coqdocvar{split\_occ}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{A\_eq\_dec} \coqdocvar{a} \coqdocvar{v}) \coqdocvar{eqn}:\coqdocvar{HAV}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{Forall\_nil}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{destruct} \coqdocvar{split\_p} \coqdockw{as} [\coqdocvar{Left} \coqdocvar{Right}] \coqdocvar{eqn}: \coqdocvar{Hsplit}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{unfold} \coqdocvar{split\_occ} \coqdoctac{in} \coqdocvar{IHl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{rewrite} \coqdocvar{Hsplit} \coqdoctac{in} \coqdocvar{IHl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl} \coqdoctac{in} \coqdocvar{IHl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{Forall\_cons}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{exact} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\times} \coqdoctac{exact} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{split\_occ\_snd\_starts\_with\_v}: \coqdockw{\ensuremath{\forall}}\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{v}: \coqdocvar{A}) (\coqdocvar{l}: \coqdocvar{list} \coqdocvar{A}),\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{snd} (\coqdocvar{split\_occ} \coqdocvar{v} \coqdocvar{l}) = [] \ensuremath{\lor} (\coqdoctac{\ensuremath{\exists}} (\coqdocvar{l'}: \coqdocvar{list} \coqdocvar{A}), \coqdocvar{snd}(\coqdocvar{split\_occ} \coqdocvar{v} \coqdocvar{l}) = \coqdocvar{v} :: \coqdocvar{l'}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{v} \coqdocvar{l}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{split\_occ}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{l}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl}. \coqdoctac{left}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{A\_eq\_dec} \coqdocvar{a} \coqdocvar{v}) \coqdocvar{eqn}:\coqdocvar{Hav}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{right}. \coqdoctac{\ensuremath{\exists}} \coqdocvar{l}. \coqdoctac{rewrite} \coqdocvar{e}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{destruct} (\coqdocvar{split\_p} (\coqdockw{fun} \coqdocvar{x} \ensuremath{\Rightarrow} \coqdockw{if} \coqdocvar{A\_eq\_dec} \coqdocvar{x} \coqdocvar{v} \coqdockw{then} \coqdocvar{true} \coqdockw{else} \coqdocvar{false}) \coqdocvar{l}) \coqdocvar{eqn}:\coqdocvar{Hsplit}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{exact} \coqdocvar{IHl}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Parameter} \coqdocvar{T} : \coqdockw{Type}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Parameter} \coqdocvar{T\_eq\_dec}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{x} \coqdocvar{y} : \coqdocvar{T}), \{\coqdocvar{x}=\coqdocvar{y}\} + \{\~{}\coqdocvar{x}=\coqdocvar{y}\}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{multiset} := \coqdocvar{list} (\coqdocvar{T}\ensuremath{\times}\coqdocvar{nat}).\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{empty} : \coqdocvar{multiset} := ([]).\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{singleton} (\coqdocvar{t}:\coqdocvar{T}) : \coqdocvar{multiset} := [(\coqdocvar{t},1)].\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{member} (\coqdocvar{t}:\coqdocvar{T}) (\coqdocvar{m}:\coqdocvar{multiset}) : \coqdocvar{bool} := \coqdockw{match} \coqdocvar{m} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
|[] \ensuremath{\Rightarrow} \coqdocvar{false}\coqdoceol
\coqdocindent{1.00em}
|(\coqdocvar{x},\coqdocvar{\_})::\coqdocvar{m'} \ensuremath{\Rightarrow} \coqdockw{if} \coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{t} \coqdockw{then} \coqdocvar{true}\coqdoceol
\coqdocindent{8.00em}
\coqdockw{else} \coqdocvar{member} \coqdocvar{t} \coqdocvar{m'}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{add} (\coqdocvar{t}:\coqdocvar{T}) (\coqdocvar{n}:\coqdocvar{nat}) (\coqdocvar{m}:\coqdocvar{multiset}) : \coqdocvar{multiset} :=\coqdoceol
\coqdocnoindent
\coqdockw{if} \coqdocvar{n} == 0 \coqdockw{then} \coqdocvar{m} \coqdockw{else} \coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{m} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
|[] \ensuremath{\Rightarrow} [(\coqdocvar{t},\coqdocvar{n})]\coqdoceol
\coqdocindent{1.00em}
|(\coqdocvar{x},\coqdocvar{xn})::\coqdocvar{m'} \ensuremath{\Rightarrow} \coqdockw{if} \coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{t} \coqdockw{then} (\coqdocvar{x},\coqdocvar{xn}+\coqdocvar{n})::\coqdocvar{m'}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{else} (\coqdocvar{x},\coqdocvar{xn})::(\coqdocvar{add} \coqdocvar{t} \coqdocvar{n} \coqdocvar{m'})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{multiplicity} (\coqdocvar{t}:\coqdocvar{T}) (\coqdocvar{m}:\coqdocvar{multiset}) : \coqdocvar{nat} := \coqdockw{match} \coqdocvar{m} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
|[] \ensuremath{\Rightarrow} 0\coqdoceol
\coqdocindent{1.00em}
|(\coqdocvar{x},\coqdocvar{xn})::\coqdocvar{m'} \ensuremath{\Rightarrow} \coqdockw{if} \coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{t} \coqdockw{then} \coqdocvar{xn}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{else} \coqdocvar{multiplicity} \coqdocvar{t} \coqdocvar{m'}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{removeOne} (\coqdocvar{t}:\coqdocvar{T}) (\coqdocvar{m}:\coqdocvar{multiset}) : \coqdocvar{multiset} := \coqdockw{match} \coqdocvar{m} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
|[] \ensuremath{\Rightarrow} []\coqdoceol
\coqdocindent{1.00em}
|(\coqdocvar{x},\coqdocvar{xn})::\coqdocvar{m'} \ensuremath{\Rightarrow} \coqdockw{if} \coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{t} \coqdockw{then}\coqdoceol
\coqdocindent{10.50em}
\coqdockw{if} \coqdocvar{xn}=?1 \coqdockw{then} \coqdocvar{m'}\coqdoceol
\coqdocindent{10.50em}
\coqdockw{else} (\coqdocvar{x},\coqdocvar{xn}-1)::\coqdocvar{m'}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{else} (\coqdocvar{x},\coqdocvar{xn})::(\coqdocvar{removeOne} \coqdocvar{t} \coqdocvar{m'})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{removeAll} (\coqdocvar{t}:\coqdocvar{T}) (\coqdocvar{m}:\coqdocvar{multiset}) : \coqdocvar{multiset} := \coqdockw{match} \coqdocvar{m} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
|[] \ensuremath{\Rightarrow} []\coqdoceol
\coqdocindent{1.00em}
|(\coqdocvar{x},\coqdocvar{xn})::\coqdocvar{m'} \ensuremath{\Rightarrow} \coqdockw{if} \coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{t} \coqdockw{then} \coqdocvar{m'}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{else} (\coqdocvar{x},\coqdocvar{xn})::(\coqdocvar{removeAll} \coqdocvar{t} \coqdocvar{m'})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{InMultiset} (\coqdocvar{t}:\coqdocvar{T}) (\coqdocvar{m}:\coqdocvar{multiset}) : \coqdockw{Prop} := (\coqdocvar{member} \coqdocvar{t} \coqdocvar{m}) = \coqdocvar{true}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdockw{wf} (\coqdocvar{m}: \coqdocvar{multiset}) : \coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvar{m} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{True}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} (\coqdocvar{x}, \coqdocvar{n}) :: \coqdocvar{m'} \ensuremath{\Rightarrow}\coqdoceol
\coqdocindent{3.00em}
\coqdocvar{n} > 0 \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\coqdoceol
\coqdocindent{3.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{y} \coqdocvar{occ}, \coqdocvar{In} (\coqdocvar{y}, \coqdocvar{occ}) \coqdocvar{m'} \ensuremath{\rightarrow} \coqdocvar{y} \ensuremath{\not=} \coqdocvar{x}) \ensuremath{\land}\coqdoceol
\coqdocindent{3.00em}
\coqdoceol
\coqdocindent{3.00em}
\coqdockw{wf} \coqdocvar{m'}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{empty\_wf}: \coqdockw{wf} \coqdocvar{empty} = \coqdocvar{True}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{PeanoNat}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Coq.Logic.PropExtensionality}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{singleton\_wf}: \coqdockw{\ensuremath{\forall}} \coqdocvar{x}: \coqdocvar{T}, \coqdockw{wf} (\coqdocvar{singleton} \coqdocvar{x}) = \coqdocvar{True}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{x}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{propositional\_extensionality}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intro} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{apply} \coqdocvar{proj2} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{apply} \coqdocvar{proj2} \coqdoctac{in} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{exact} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{split}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdocvar{lia}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{split}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{intros} \coqdocvar{y} \coqdocvar{n} \coqdocvar{contr}.\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{contradiction}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{exact} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{not\_in\_after\_add\_different} : \coqdoceol
\coqdocindent{1.00em}
\coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{n} \coqdocvar{s}, \coqdocvar{x} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow} \coqdockw{wf} \coqdocvar{s} \ensuremath{\rightarrow} \coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{z} \coqdocvar{occ}, \coqdocvar{In} (\coqdocvar{z}, \coqdocvar{occ}) \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{z} \ensuremath{\not=} \coqdocvar{x}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{1.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{z} \coqdocvar{occ}, \coqdocvar{In} (\coqdocvar{z}, \coqdocvar{occ}) (\coqdocvar{add} \coqdocvar{y} \coqdocvar{n} \coqdocvar{s}) \ensuremath{\rightarrow} \coqdocvar{z} \ensuremath{\not=} \coqdocvar{x}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{y} \coqdocvar{n} \coqdocvar{s} \coqdocvar{Hxy} \coqdocvar{Hwf} \coqdocvar{Hnot\_in}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{a} \coqdocvar{an}] \coqdocvar{s'} \coqdocvar{IH}].\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl}. \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{intros} \coqdocvar{z} \coqdocvar{occ} \coqdocvar{Hin}. \coqdoctac{apply} (\coqdocvar{Hnot\_in} \coqdocvar{z} \coqdocvar{occ} \coqdocvar{Hin}).\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{z} \coqdocvar{occ} \coqdocvar{Hin}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{destruct} \coqdocvar{Hin} \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hcontra}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{inversion} \coqdocvar{Heq}. \coqdoctac{subst}. \coqdoctac{symmetry}. \coqdoctac{exact} \coqdocvar{Hxy}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{inversion} \coqdocvar{Hcontra}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Hwf}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} \coqdocvar{Hwf} \coqdockw{as} [\coqdocvar{Han\_pos} [\coqdocvar{Hnot\_in\_s'} \coqdocvar{Hwf\_s'}]].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{intros} \coqdocvar{z} \coqdocvar{occ} \coqdocvar{Hin}. \coqdoctac{apply} (\coqdocvar{Hnot\_in} \coqdocvar{z} \coqdocvar{occ} \coqdocvar{Hin}).\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{a} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Hay} \ensuremath{|} \coqdocvar{Hnay}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{subst} \coqdocvar{a}. \coqdoctac{intros} \coqdocvar{z} \coqdocvar{occ} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hin'}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{inversion} \coqdocvar{Heq}. \coqdoctac{subst}. \coqdoctac{symmetry}. \coqdoctac{exact} \coqdocvar{Hxy}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{apply} (\coqdocvar{Hnot\_in} \coqdocvar{z} \coqdocvar{occ}). \coqdoctac{right}. \coqdoctac{exact} \coqdocvar{Hin'}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{intros} \coqdocvar{z} \coqdocvar{occ} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hin'}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{inversion} \coqdocvar{Heq}. \coqdoctac{subst}.\coqdoceol
\coqdocindent{5.50em}
\coqdoctac{apply} (\coqdocvar{Hnot\_in} \coqdocvar{z} \coqdocvar{occ}). \coqdoctac{left}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{apply} (\coqdocvar{IH} \coqdocvar{Hwf\_s'} \coqdoceol
\coqdocindent{5.00em}
(\coqdockw{fun} \coqdocvar{w} \coqdocvar{wocc} \coqdocvar{Hw} \ensuremath{\Rightarrow} \coqdocvar{Hnot\_in} \coqdocvar{w} \coqdocvar{wocc} (\coqdocvar{or\_intror} \coqdocvar{Hw})) \coqdocvar{z} \coqdocvar{occ} \coqdocvar{Hin'}).\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{add\_to\_empty\_wf} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{n}, \coqdocvar{n} > 0 \ensuremath{\rightarrow} \coqdockw{wf} [(\coqdocvar{x}, \coqdocvar{n})].\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{n} \coqdocvar{Hn}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; [\coqdoctac{exact} \coqdocvar{Hn} \ensuremath{|} \coqdoctac{split}].\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{intros} \coqdocvar{y} \coqdocvar{occ} \coqdocvar{Hin}. \coqdoctac{inversion} \coqdocvar{Hin}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{exact} \coqdocvar{I}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{add\_wf}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{x}: \coqdocvar{T}) (\coqdocvar{n}: \coqdocvar{nat}) (\coqdocvar{s}: \coqdocvar{multiset}), \coqdockw{wf} \coqdocvar{s} \ensuremath{\rightarrow} \coqdockw{wf} (\coqdocvar{add} \coqdocvar{x} \coqdocvar{n} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{n} \coqdocvar{s} \coqdocvar{Hwf}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{a} \coqdocvar{an}] \coqdocvar{s'} \coqdocvar{IH}].\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl}. \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{exact} \coqdocvar{Hwf}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{add\_to\_empty\_wf}. \coqdocvar{lia}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Hwf}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{destruct} \coqdocvar{Hwf} \coqdockw{as} [\coqdocvar{Han\_pos} [\coqdocvar{Hnot\_in\_s'} \coqdocvar{Hwf\_s'}]].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}. \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{split}; [\coqdoctac{exact} \coqdocvar{Han\_pos} \ensuremath{|} \coqdoctac{split}; [\coqdoctac{exact} \coqdocvar{Hnot\_in\_s'} \ensuremath{|} \coqdoctac{exact} \coqdocvar{Hwf\_s'}]].\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{a} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Hax} \ensuremath{|} \coqdocvar{Hnax}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{subst} \coqdocvar{a}. \coqdoctac{simpl}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{split}; [\coqdocvar{lia} \ensuremath{|} \coqdoctac{split}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{exact} \coqdocvar{Hnot\_in\_s'}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{exact} \coqdocvar{Hwf\_s'}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{simpl}. \coqdoctac{split}; [\coqdoctac{exact} \coqdocvar{Han\_pos} \ensuremath{|} \coqdoctac{split}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{intros} \coqdocvar{y} \coqdocvar{occ} \coqdocvar{Hin\_add}.\coqdoceol
\coqdocindent{5.50em}
\coqdoctac{apply} \coqdocvar{not\_in\_after\_add\_different} \coqdockw{with} (\coqdocvar{x} := \coqdocvar{a}) (\coqdocvar{y} := \coqdocvar{x}) (\coqdocvar{n} := \coqdocvar{S} \coqdocvar{n}) (\coqdocvar{s} := \coqdocvar{s'}) \coqdoctac{in} \coqdocvar{Hin\_add}.\coqdoceol
\coqdocindent{5.50em}
++ \coqdoctac{exact} \coqdocvar{Hin\_add}.\coqdoceol
\coqdocindent{5.50em}
++ \coqdoctac{exact} \coqdocvar{Hnax}.\coqdoceol
\coqdocindent{5.50em}
++ \coqdoctac{exact} \coqdocvar{Hwf\_s'}.\coqdoceol
\coqdocindent{5.50em}
++ \coqdoctac{exact} \coqdocvar{Hnot\_in\_s'}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{apply} \coqdocvar{IH}. \coqdoctac{exact} \coqdocvar{Hwf\_s'}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{removeOne\_wf}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{s}: \coqdocvar{multiset}) (\coqdocvar{x}: \coqdocvar{T}), \coqdockw{wf} \coqdocvar{s} \ensuremath{\rightarrow} \coqdockw{wf} (\coqdocvar{removeOne} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{x} \coqdocvar{Hwf}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{a} \coqdocvar{an}] \coqdocvar{s'} \coqdocvar{IH}].\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl} \coqdoctac{in} *. \coqdoctac{exact} \coqdocvar{Hwf}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Hwf}. \coqdoctac{destruct} \coqdocvar{Hwf} \coqdockw{as} [\coqdocvar{Han\_pos} [\coqdocvar{Hnot\_in\_s'} \coqdocvar{Hwf\_s'}]].\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{case} (\coqdocvar{an} == 1).\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{intro} \coqdocvar{Han}. \coqdoctac{rewrite} \coqdocvar{Han}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{a} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Hax} \ensuremath{|} \coqdocvar{Hnax}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{exact} \coqdocvar{Hwf\_s'}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{simpl}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{lia}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{admit}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{exact} (\coqdocvar{IH} (\coqdocvar{Hwf\_s'})).\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{intro} \coqdocvar{Han}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{assert} (\coqdocvar{an} \ensuremath{\not=} 1).\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{assumption}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{a} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Hax} \ensuremath{|} \coqdocvar{Hnax}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{assert}(\coqdocvar{rewH}:= \coqdocvar{H}). \coqdoctac{rewrite} \ensuremath{\leftarrow} \coqdocvar{Nat.eqb\_neq} \coqdoctac{in} \coqdocvar{rewH}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{rewrite} \coqdocvar{rewH}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{4.00em}
\coqdocvar{lia}.\coqdoceol
\coqdocindent{4.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{exact} \coqdocvar{Hnot\_in\_s'}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{exact} \coqdocvar{Hwf\_s'}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{removeAll\_wf}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{s}: \coqdocvar{multiset}) (\coqdocvar{x}: \coqdocvar{T}), \coqdockw{wf} \coqdocvar{s} \ensuremath{\rightarrow} \coqdockw{wf} (\coqdocvar{removeAll} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{x\_not\_in\_empty} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \ensuremath{\lnot} \coqdocvar{InMultiset} \coqdocvar{x} \coqdocvar{empty}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{unfold} \coqdocvar{InMultiset} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H}. \coqdoctac{discriminate}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prop\_2} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} , \coqdocvar{InMultiset} \coqdocvar{y} (\coqdocvar{singleton} \coqdocvar{x}) \ensuremath{\leftrightarrow} \coqdocvar{x} = \coqdocvar{y}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{InMultiset}, \coqdocvar{singleton}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{1.00em}
-\coqdoctac{split}.\coqdoceol
\coqdocindent{2.00em}
+\coqdoctac{intros}. \coqdoctac{exact} \coqdocvar{Heq}.\coqdoceol
\coqdocindent{2.00em}
+\coqdoctac{intros}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
-\coqdoctac{split}.\coqdoceol
\coqdocindent{2.00em}
+\coqdoctac{intros}. \coqdoctac{discriminate} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
+\coqdoctac{intros}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prop\_3} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x}, \coqdocvar{multiplicity} \coqdocvar{x} (\coqdocvar{singleton} \coqdocvar{x}) = 1.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{singleton}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{1.00em}
-\coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
-\coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prop\_4} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{s}, \coqdockw{wf} \coqdocvar{s} \ensuremath{\rightarrow} (\coqdocvar{member} \coqdocvar{x} \coqdocvar{s} = \coqdocvar{true} \ensuremath{\leftrightarrow} \coqdocvar{InMultiset} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}; \coqdoctac{unfold} \coqdocvar{InMultiset}; \coqdoctac{intro}; \coqdoctac{exact} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prop\_5} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{n} \coqdocvar{s}, \coqdocvar{n} > 0 \ensuremath{\rightarrow} \coqdocvar{InMultiset} \coqdocvar{x} (\coqdocvar{add} \coqdocvar{x} \coqdocvar{n} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{InMultiset}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{n} \coqdockw{as} [| \coqdocvar{n'}].\coqdoceol
\coqdocindent{1.00em}
- \coqdocvar{lia}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{y} \coqdocvar{k}] \coqdocvar{s'} \coqdocvar{IH}].\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq}\ensuremath{|}\coqdocvar{Hneq}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{y} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq}\ensuremath{|}\coqdocvar{Hneq}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{simpl}. \coqdoctac{subst} \coqdocvar{y}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq2}\ensuremath{|}\coqdocvar{Hneq2}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{y} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq2}\ensuremath{|}\coqdocvar{Hneq2}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{apply} \coqdocvar{IH}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prop\_6} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{y} \coqdocvar{n} \coqdocvar{s}, \coqdocvar{x} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow} (\coqdocvar{InMultiset} \coqdocvar{y} (\coqdocvar{add} \coqdocvar{x} \coqdocvar{n} \coqdocvar{s}) \ensuremath{\leftrightarrow} \coqdocvar{InMultiset} \coqdocvar{y} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{2.00em}
- \coqdoctac{intro}. \coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{z} \coqdocvar{k}] \coqdocvar{s'} \coqdocvar{IH}]. \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{3.00em}
+ \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{exact} \coqdocvar{H0}.\coqdoceol
\coqdocindent{3.00em}
+ \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}. \coqdoctac{assert} (\coqdocvar{Hnz} : \coqdocvar{S} \coqdocvar{n} \ensuremath{\not=} 0) \coqdoctac{by} \coqdoctac{discriminate}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{4.00em}
\ensuremath{\times} \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
\ensuremath{\times} \coqdocvar{admit}.\coqdoceol
\coqdocindent{3.00em}
+ \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{4.00em}
\ensuremath{\times} \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
\ensuremath{\times} \coqdocvar{admit}.\coqdoceol
\coqdocindent{2.00em}
- \coqdoctac{intro}. \coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{z} \coqdocvar{k}] \coqdocvar{s'} \coqdocvar{IH}]. \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{3.00em}
+ \coqdoctac{simpl}. \coqdoctac{exact} \coqdocvar{H0}.\coqdoceol
\coqdocindent{3.00em}
+ \coqdoctac{unfold} \coqdocvar{InMultiset}. \coqdoctac{unfold} \coqdocvar{InMultiset} \coqdoctac{in} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prop\_7} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{s}, \coqdockw{wf} \coqdocvar{s} \ensuremath{\rightarrow} (\coqdocvar{multiplicity} \coqdocvar{x} \coqdocvar{s} = 0 \ensuremath{\leftrightarrow} \ensuremath{\lnot}\coqdocvar{InMultiset} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{split}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{intro}. \coqdoctac{unfold} \coqdocvar{not}, \coqdocvar{InMultiset}. \coqdoctac{intro}. \coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{y} \coqdocvar{n}] \coqdocvar{s'} \coqdocvar{IH}].\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}, \coqdocvar{H1}. \coqdoctac{discriminate}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{H0}, \coqdocvar{H1}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{y} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{Hn} [\coqdocvar{Hh1} \coqdocvar{Hh2}]]. \coqdocvar{lia}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{apply} \coqdocvar{IH}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{Hn} [\coqdocvar{Hh1} \coqdocvar{Hh2}]].\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{apply} \coqdocvar{Hh2}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{apply} \coqdocvar{H0}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{apply} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{intro}. \coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{y} \coqdocvar{n}] \coqdocvar{s'} \coqdocvar{IH}].\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{y} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{subst} \coqdocvar{y}. \coqdoctac{destruct} \coqdocvar{H} \coqdockw{as} [\coqdocvar{Hn} [\coqdocvar{Hh1} \coqdocvar{Hh2}]].\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prop\_8} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{n} \coqdocvar{s}, \coqdocvar{multiplicity} \coqdocvar{x} (\coqdocvar{add} \coqdocvar{x} \coqdocvar{n} \coqdocvar{s}) = \coqdocvar{n} + (\coqdocvar{multiplicity} \coqdocvar{x} \coqdocvar{s}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{y} \coqdocvar{k}] \coqdocvar{s'} \coqdocvar{IH}].\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl}. \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdocvar{lia}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{y} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{subst} \coqdocvar{y}. \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{lia}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{y} \coqdocvar{x}).\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{rewrite} \coqdocvar{IH}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Lemma} \coqdocvar{prop\_9} : \coqdockw{\ensuremath{\forall}} \coqdocvar{x} \coqdocvar{n} \coqdocvar{y} \coqdocvar{s}, \coqdocvar{x} \ensuremath{\not=} \coqdocvar{y} \ensuremath{\rightarrow} \coqdockw{wf} \coqdocvar{s} \ensuremath{\rightarrow} \coqdocvar{multiplicity} \coqdocvar{y} (\coqdocvar{add} \coqdocvar{x} \coqdocvar{n} \coqdocvar{s}) = \coqdocvar{multiplicity} \coqdocvar{y} \coqdocvar{s}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{x} \coqdocvar{n} \coqdocvar{y} \coqdocvar{s} \coqdocvar{Hxy} \coqdocvar{Hwf}. \coqdocvar{revert} \coqdocvar{n}. \coqdocvar{revert} \coqdocvar{x} \coqdocvar{y} \coqdocvar{Hxy}. \coqdoctac{induction} \coqdocvar{s} \coqdockw{as} [| [\coqdocvar{z} \coqdocvar{k}] \coqdocvar{s'} \coqdocvar{IH}]; \coqdoctac{intros}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl}. \coqdoctac{destruct} \coqdocvar{n}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}.\coqdoceol
\coqdocindent{3.00em}
\coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
- \coqdoctac{simpl} \coqdoctac{in} \coqdocvar{Hwf}. \coqdoctac{destruct} \coqdocvar{Hwf} \coqdockw{as} [\coqdocvar{Hk\_pos} [\coqdocvar{Hnot\_in\_s'} \coqdocvar{Hwf\_s'}]]. \coqdoctac{simpl}. \coqdoctac{destruct} \coqdocvar{n} \coqdockw{as} [| \coqdocvar{n'}].\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{z} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq1} \ensuremath{|} \coqdocvar{Hneq1}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{subst}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{y} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq2} \ensuremath{|} \coqdocvar{Hneq2}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{symmetry} \coqdoctac{in} \coqdocvar{Heq2}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{simpl}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{z} \coqdocvar{y}).\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{admit}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{z} \coqdocvar{x}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{subst}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq2} \ensuremath{|} \coqdocvar{Hneq2}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq} \ensuremath{|} \coqdocvar{Hneq}].\coqdoceol
\coqdocindent{5.00em}
++ \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{5.00em}
++ \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{3.00em}
\ensuremath{\times} \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{z} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq2} \ensuremath{|} \coqdocvar{Hneq2}].\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{subst}. \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{x} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq2} \ensuremath{|} \coqdocvar{Hneq2}].\coqdoceol
\coqdocindent{5.00em}
++ \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{5.00em}
++ \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{y} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq3} \ensuremath{|} \coqdocvar{Hneq3}].\coqdoceol
\coqdocindent{6.00em}
** \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{6.00em}
** \coqdocvar{admit}.\coqdoceol
\coqdocindent{4.00em}
-- \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{T\_eq\_dec} \coqdocvar{z} \coqdocvar{y}) \coqdockw{as} [\coqdocvar{Heq3} \ensuremath{|} \coqdocvar{Hneq3}].\coqdoceol
\coqdocindent{5.00em}
++ \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{5.00em}
++ \coqdocvar{admit}.\coqdoceol
\coqdocnoindent
\coqdocvar{Admitted}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
